<?php

namespace App\Console\Commands;

use App\Models\V2\Projects\Project;
use App\Models\V2\Sites\Site;
use App\Models\V2\Tasks\Task;
use Illuminate\Console\Command;
use Illuminate\Support\Str;

class RunMigrateFoncetProject extends Command
{
    // php artisan app:migrate-foncet-project migrate

    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    protected $signature = 'app:migrate-foncet-project';

    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'Command description';

    private $rebivtaSites = ['Bosque Encantado',
'Higland',
'El Desengaño CDE',
'El Desengaño FEG',
'El Desengaño PBC',
'El Desengaño VPE',
'El Desengaño CRR',
'REBIVTA-MPV-FONCET',
'REBIVTA-QPV-FONCET',
'REBIVTA-JCLL-FONCET',
'REBIVTA-DMR-FONCET',
'REBIVTA-JALS-FONCET',
'REBIVTA-EPV-FONCET',
'REBIVTA-ECZD-FONCET',
'REBIVTA-APE-FONCET',
'FONCET-CDO-REBIVTA 2023',];

    private $rebitriSites = ['REBITRI-OP-ALR-FONCET',
'REBITRI-OP-RPR-FONCET',
'REBITRI-OP-DVR-FONCET',
'REBITRI-OP-APS-FONCET',
'REBITRI-OP-MCR-FONCET',
'REBITRI-OP-ILGT-FONCET',
'REBITRI-OP-URM-FONCET',
'REBITRI-OP-RGL-FONCET',
'REBITRI-OP-MRC-FONCET',
'REBITRI-OP-PSR-FONCET',
'REBITRI-EC-PRR-FONCET',
'REBITRI-EC-ECRB-FONCET',
'REBITRI-EC-RSC-FONCET',
'REBITRI-EC-VCRS- FONCET',
'REBITRI-EC-CRR-FONCET',
'REBITRI-EC-ARC-FONCET',
'REBITRI-EC-ORC-FONCET',
'REBITRI-EC-PGV-FONCET',
'REBITRI-EC-PGC-FONCET',
'REBITRI-EC-FSG-FONCET',
'REBITRI-EC-MHP-FONCET',
'REBITRI-M-WMJ-FONCET',
'REBITRI-M-MAGH-FONCET',
'REBITRI-MRCS-FONCET',
'REBITRI-M-MAM-FONCET',
'REBITRI-MJRM.FONCET',
'REBITRI-M-ERM-FONCET',
'REBITRI-M-ECG-FONCET',
'REBITRI-M-GCE-FONCET',
'REBITRI-M-RMV-FONCET',
'REBITRI-M-IAMV-FONCET',
'REBITRI-M-NVG-FONCET',
'REBITRI-M-RHM-FONCET',
'REBITRI-UPM-UML-FONCET',
'REBITRI-UPM-VSM-FONCET',
'REBITRI-UPM-ESR-FONCET',
'REBITRI-UPM-AVS-FONCET',
'REBITRI-UPM-CMR-FONCET',
'REBITRI-UPM-EMV-FONCET',
'REBITRI-UPM-VSL-FONCET',
'REBITRI-EA-DGO-FONCET',
'REBITRI-RLH-SGR-POL1-FONCET-23',
'REBITRI-EC-AGDL-FONCET',
'REBITRI-EF-RSL-FONCET',
'REBITRI-PL-LC-31-FONCET',
'REBITRI-LE-GMP-FONCET',
'REBITRI-ED-VSL-FONCET',
'REBITRI-ECA-AMR-FONCET',
'REBITRI-ELL-JAV-FONCET',
'REBITRI-SLN-MAP-3-FONCET',
'REBITRI-SLN-MTO-FONCET',
'REBITRI-SLN-MAP-7-FONCET',
'REBITRI-SLN-MAP-14-FONCET',
'REBITRI-SLN-EMR-FONCET',
'REBITRI-SLN-MVP-FONCET',
'REBITRI-A-DGLM-FONCET',
'REBITRI-A-LFVG-FONCET',
'REBITRI-A-MXP-FONCET',
'REBITRI-A-MDMG-FONCET',
'REBITRI-A-JLP-FONCET',
'REBITRI-A-OGRS-FONCET',
'REBITRI-A-JLM-JRH-2-FONCET',
'REBITRI-A-NEGT-FONCET',
'REBITRI-A-HFGR-FONCET',
'REBITRI-A-OPM-FONCET',
'REBITRI-A-APL-FONCET',
'REBITRI-A-RMV-FONCET',
'REBITRI-A-FVG-FONCET',
'REBITRI-A-CVP-FONCET',
'REBITRI-A-EGV-FONCET',
'REBITRI-A-ELM-GLV-2-FONCET',
'REBITRI-A-ZEGM-FONCET',
'REBITRI-A-CGR-FONCET',
'REBITRI-A-HNL-FONCET',
'REBITRI-A-LLM-FONCET',
'REBITRI-A-MRMT-FONCET',
'REBITRI-A-LVMT-FONCET',
'REBITRI-EVSP1-PIJ-7PRO-FONCET',
'REBITRI-EVSP2-PIJ-7PRO-FONCET',
'REBITRI-EVSP3-PIJ-7PRO-FONCET',
'REBITRI-EVSP4-PIJ-7PRO-FONCET',
'REBITRI-LA-ACA-16-FONCET',
'REBITRI-LA-ACA-6-FONCET',
'REBITRI-GOL-ACA-13-FONCET',
'REBITRI-DA-ACA-18-FONCET',
'REBITRI-RLH-SGR-POL2-FONCET',
'REBITRI-CYN-LC-2GA-FONCET',
'REBITRI-CYN-LC-2AM-FONCET',
'REBITRI-COMON-LC-2AT-FONCET',
'REBITRI-CYN-LC-2BC-FONCET',
'REBITRI-CYN-LC-2JE-FONCET',
'REBITRI-CYN-LC-2JP-FONCET',
'REBITRI-CYN-LC-2MA-FONCET',
'REBITRI-CYN-LC-2MM-FONCET',
'REBITRI-CYN-LC-2MN-FONCET-23',
'REBITRI-CYN-LC-2PE-FONCET-23',
'REBITRI-CYN-LC-2RE-FONCET-23',
'REBITRI-CYN-LC-3SFM-FONCET-23',
'REBITRI-CYN-LC-7DMEMBMM-FONCET-23',
'REBITRI-CYN-LC-7FMLJCJR-FONCET-23',
'REBITRI-CYN-LC-7SJAAAEA-FONCET-23',
'REBITRI-CYN-LC-11PAJGDLBVPAL-FONCET-23',
'REBITRI-RZ-ACA-35-FONCET-23',
'REBITRI-EC-MAP-2 EGM-GGV-FONCET-23',
'REBITRI-EC-MAP-2-EHZ-EIGG-FONCET-23',
'REBITRI-EC-MAP-2-AVL-FLA-FONCET-23',
'REBITRI-EC-MAP-2-GGL-FMV-FONCET-23',
'REBITRI-EC-MAP-2-JHS-MCSR-FONCET-23',
'REBITRI-EC-AZN-FONCET-23',
'REBITRI-EC-CMC-FONCET-23',
'REBITRI-EC-IDP-FONCET-23',
'REBITRI-EC-BDML-FONCET-23',
'REBITRI-EC-AML-FONCET-23',
'REBITRI-EC-VGV-FONCET-23',
'REBITRI-EC-FJSM-FONCET-23',
'REBITRI-EC-FML-FONCET-23',
'REBITRI-EC-JLMM-FONCET-23',
'REBITRI-EC-SMS-FONCET-23',
'REBITRI-EC-DVM-FONCET-23',
'REBITRI-EC-AVP-FONCET-23',
'REBITRI-EC-AAC-FONCET-23',
'REBITRI-EC-AYML-FONCET-23',
'REBITRI-EC-DVV-FONCET-23',
'REBITRI-EC-RLL-FONCET-23',
'REBITRI-LCH-PIJ-23-FONCET-23',
'REBITRI-NT-PIJ-5-FONCET-23',
'REBITRI-NT-PIJ-4-FONCET-23',
'REBITRI-ER-PIJ-2-EDS-FDM-FONCET-23',
'REBITRI-ER-PIJ-2-CHD-OML-FONCET-23',
'REBITRI-ER-PIJ-2-APM-EDP-FONCET-23',
'REBITRI-ER-PIJ-7-FONCET-23',
'REBITRI-ER-ADP-FONCET-23',
'REBITRI-ER-AMP-FONCET-23',
'REBITRI-ER-BPM-FONCET-23',
'REBITRI-ER-DDP-FONCET-23',
'REBITRI-ER-EABT-FONCET-23',
'REBITRI-ER-FVP-FONCET-23',
'REBITRI-ER-JPM-FONCET-23',
'REBITRI-ER-VPM-FONCET-23',
'REBITRI-EZ-PIJ-3-FONCET-23',
'REBITRI-EZ-PIJ-9-FONCET-23',
'REBITRI-EZ-DBS-FONCET-23',
'REBITRI-LP-PIJ-3-FONCET-23',
'REBITRI-LP-MPG-FONCET-23',
'REBITRI-LP-OSRL-FONCET-23',
'REBITRI-LP-NPG-FONCET-23',
'REBITRI-LP-RRD-FONCET-23',
'REBITRI-LP-ORS-FONCET-23',
'REBITRI-LP-GCA-FONCET-23',
'REBITRI-LP-RMV-FONCET-23',
'REBITRI-LP-APP-FONCET-23',
'REBITRI-LP-LMP-FONCET-23',
'REBITRI-REC-SZH-FONCET-23',
'REBITRI-M-ACG-FONCET-23',
'REBITRI-G-PIJ-7-FONCET-23',
'REBITRI-VC-PIJ-9-FONCET-23',
'REBITRI-PA-PIJ-2-VRH-HVB-FONCET-23',
'REBITRI-PA-PIJ-2-ORB-LJV-FONCET-23',
'REBITRI-PA-MHL-FONCET-23',
'REBITRI-PA-ARR-FONCET-23',
'REBITRI-PA-RVB-FONCET-23',
'REBITRI-PA-SOV-FONCET-23',
'REBITRI-PA-EPG-FONCET-23',
'REBITRI-PA-MRP-FONCET-23',
'REBITRI-PA-PPG-FONCET-23',
'REBITRI-PA-ERG-FONCET-23',
'REBITRI-PA-GGG-FONCET-23',
'REBITRI-PA-AHL-FONCET-23',
'REBITRI-PA-BRR-FONCET-23',
'REBITRI-PA-ADRR-FONCET-23',
'REBITRI-PA-ZRL-FONCET-23',
'REBITRI-PA-YRH-FONCET-23',
'REBITRI-PA-EGM-FONCET-23',
'REBITRI-PA-VMSR-FONCET-23',
'REBITRI-PA-JECV-FONCET-23',
'REBITRI-PA-UCV-FONCET-23',
'REBITRI-PA-RDM-FONCET-23',
'REBITRI-PA-ARRO-FONCET-23',
'REBITRI-PA-PRM-FONCET-23',
'REBITRI-PA-MRM-FONCET-23',
'REBITRI-PA-JRH-FONCET-23',
'REBITRI-PA-JAGDL-FONCET-23',
'REBITRI-PA-SMR-FONCET-23',
'REBITRI-BA-PIJ-13-FONCET-23',
'REBITRI-SAM-PIJ-2- AGG-AGG-FONCET-23',
'REBITRI-SAM-PIJ-2-AGH-AGH-FONCET-23',
'REBITRI-SAM-PIJ-2-RGD-JGD-FONCET-23',
'REBITRI-SAM-ALM-FONCET-23',
'REBITRI-SAM-FVM-FONCET-23',
'REBITRI-SAM-JGI-FONCET-23',
'REBITRI-SAM-AHD-FONCET-23',
'REBITRI-SAM-DMV-FONCET-23',
'REBITRI-SAM-CLHD-FONCET-23',
'REBITRI-SAM-JVD-FONCET-23',
'REBITRI-EV-PIJ-21-FONCET-23',
'REBITRI-EV-PIJ-6-FONCET-23',
'REBITRI-EV-PIJ-3-FONCET-23',
'REBITRI-EV-PIJ-2-MAPG-DSM-FONCET-23',
'REBITRI-EV-PIJ-2-BMS-BPS-FONCET-23',
'REBITRI-EV-NMD-FONCET-23',
'REBITRI-EV-FJGJ-FONCET-23',
'REBITRI-EV-BSV-FONCET-23',
'REBITRI-EV-GGL-FONCET-23',
'REBITRI-EV-PSM-FONCET-23',
'REBITRI-EV-EGG-FONCET-23',
'REBITRI-EV-DDSH-FONCET-23',
'REBITRI-EV-ASM-FONCET-23',
'REBITRI-EV-ANSM-FONCET-23',
'REBITRI-EV-ESM-FONCET-23',
'REBITRI-EV-HSV-FONCET-23',
'REBITRI-EV-UPS-FONCET-23',
'REBITRI-EV-MVM-FONCET-23',
'REBITRI-EV-GGH-FONCET-23',
'REBITRI-EV-GVP-FONCET-23',
'REBITRI-EV-FGC-FONCET-23',
'REBITRI-EV-ARA-FONCET-23',
'REBITRI-EV-MAL-FONCET-23',
'REBITRI-EV-RSG-FONCET-23',
'REBITRI-EV-AVS-FONCET-23',
'REBITRI-DGO-RNA-FONCET-2023',
'REBITRI-SGR-RNA-FONCET-2024'];

    protected $rebisoSites = [
            'REBISO-ADVC-AC--FONCET',
            'REBISO-ADVC-NF1-FONCET',
            'REBISO-ADVC-ANG-FONCET',
            'REBISO-ADVC-JDG-FONCET',
            'REBISO-ADVC-JGV-FONCET',
            'REBISO-ADVC-LLS-FONCET',
            'REBISO-ADVC-LPH-FONCET',
            'REBISO-ADVC-NLM-FONCET',
            'REBISO-ADVC-PHR-FONCET',
            'REBISO-ADVC-VDG-FONCET',
            'REBISO-ADVC-NJ1-FONCET',
            'REBISO-ADVC-NJ2-FONCET',
            'REBISO-ADVC-MPH-FONCET',
            'REBISO-ADVC-DLP-FONCET',
            'REBISO-ADVC-IPP-FONCET',
            'REBISO-ADVC-JPP-FONCET',
            'REBISO-ADVC-OLH-FONCET',
            'REBISO-ADVC-GPP-FONCET',
            'REBISO-ADVC-MLH-FONCET',
            'REBISO-ADVC-PHH-FONCET',
            'REBISO-ADVC-ALP-FONCET',
            'REBISO-ADVC-GPL-FONCET',
            'REBISO-ADVC-RHH-FONCET',
            'REBISO-ADVC-OC1-FONCET',
            'REBISO-ADVC-LGO-FONCET',
            'REBISO-ADVC-JGO-FONCET',
            'REBISO-ADVC-GGP-FONCET',
            'REBISO-ADVC-AGP-FONCET',
            'REBISO-ADVC-OC2-FONCET',
            'REBISO-ADVC-MJM-FONCET',
            'REBISO-ADVC-GVG-FONCET',
            'REBISO-ADVC-TGL-FONCET',
            'REBISO-ADVC-RGG-FONCET',
            'REBISO-ADVG-VPP-FONCET',
            'REBISO-ADVG-RH2-FONCET',
            'REBISO-ADVG-BHH-FONCET',
            'REBISO-ADVG-IP2-FONCET',
            'REBISO-ADVG-DL2-FONCET',
            'REBISO-ADVG-CDP-FONCET',
            'REBISO-ADVG-SPH-FONCET',
            'REBISO-ADVG-HLLL-FONCET',
            'REBISO-RT-FID-LFS1',
            'REBISO-RT-ADVC-FVS1',
            'REBISO-RT-ADVC-ACS1',
            'REBISO-RT-ACS2',
            'REBISO-RT-ADVC-LGS1',
            'REBISO-RNA-ADVC-LGS1',
            'REBISO-RNA-FID-LFS1',
            'REBISO-RNA-ADVC-FVS1',
            'REBISO-RNA-ADVC-ACS1',
            'REBISO-RNA-NJS1',
            'REBISO-RNA-NJS2',
            'REBISO-RT-NJS1',
            'REBISO-RT-NJS2',
            'REBISO-RT-NJS3',
            'REBISO-RT-NJS4',
            'REBISO-RT-NJS5',
            'REBISO-RT-NJS6',
            'REBISO-RT-NJS7',
            'REBISO-RT-NJS8',
            'REBISO-RT-NJS9',
            'REBISO-RT-NJS10',
            'REBISO-RT-NJS11',
            'REBISO-RT-NJS12',
            'REBISO-RT-NJS13',
            'REBISO-RT-NJS14',
            'REBISO-RT-NJS15',
            'REBISO-RT-NJS16',
            'REBISO-RT-NJS17',
            'REBISO-RT-NJS18',
            'REBISO-RA-OCS1',
            'REBISO-RA-OCS2',
            'REBISO-RA-OCS3',
            'REBISO-RA-OCS4',
            'REBISO-RA-OCS5',
            'REBISO-RA-OCS6',
            'REBISO-RA-OCS7',
            'REBISO-RA-OCS8',
            'REBISO-RA-OCS9',
            'REBISO-RA-OCS10',
            'REBISO-RA-OCS11',
            'REBISO-RA-OCS12',
            'REBISO-RA-OCS13',
            'REBISO-RA-OCS14',
            'REBISO-RA-OCS15',
            'REBISO-RA-OCS16',
            'REBISO-RA-OCS17',
            'REBISO-RA-OCS18',
            'REBISO-RA-OCS19',
            'REBISO-RA-OCS20',
            'REBISO-RA-OCS21',
            'REBISO-RA-OCS22',
            'REBISO-RA-OCS23',
            'REBISO-RA-OCS24',
            'REBISO-RA-OCS25',
            'REBISO-RA-OCS26',
            'REBISO-RA-OCS27',
            'REBISO-RA-OCS28',
            'REBISO-RA-OCS29',
            'REBISO-RA-OCS30',
            'REBISO-RA-OCS31',
            'REBISO-RA-OCS32',
            'REBISO-RA-OCS33',
            'REBISO-RA-OCS34',
            'REBISO-RA-OCS35',
            'REBISO-RA-OCS36',
            'REBISO-RA-OCS37',
            'REBISO-RA-OCS41',
            'REBISO-RA-OCS42',
            'REBISO-RA-OCS47',
            'REBISO-RA-OCS39',
            'REBISO-RA-OCS43',
            'REBISO-RA-OCS44',
            'REBISO-RA-OCS45',
            'REBISO-RA-OCS46',
            'REBISO-RA-OCS48',
            'REBISO-RA-OCS49',
            'REBISO-RA-OCS38',
            'REBISO-RA-OCS40',
            'REBISO-RNA-FA1',
            'REBISO-RNA-FA2',
            'REBISO-RNA-FA3',
            'REBISO-RNA-FA4',
        ];

    protected $rebiseSites = [
    'REBISE-FV-AFR-FONCET',
    'REBISE-RFM-UGG-FONCET',
    'REBISE-LA-GGO-FONCET',
    'REBISE-VC-EHL-FONCET',
    'REBISE-RN-VH-JJLC-FONCET',
    'REBISE-NI-JLH-FONCET',
    'REBISE-CA-MRR-FONCET',
    'REBISE-CV-MASP-FONCET',
    'REBISE-5F-NRZ-FONCET',
    'REBISE-VH-MGV-MCM-MGC-FONCET',
    'REBISE-VH-JCRM-FONCET',
    'REBISE-SAF-VH-JJLC-FONCET',
    'REBISE-VH-DCS-FONCET',
    'REBISE-VH-MGG-FONCET',
    'REBISE-VH-AGG-FONCET',
    'REBISE-VH-ALL-FONCET',
    'REBISE-VH-GGC-FONCET',
    'REBISE-VH-LGC-FONCET',
    'REBISE-VH-RVV-FONCET',
    'REBISE-VH-ALM-FONCET',
    'REBISE-VH-ECM-FONCET',
    'REBISE-VH-SGG-FONCET',
    'REBISE-JOD-GLL-FONCET',
    'REBISE-JOD-MLL-FONCET',
    'REBISE-JOD-MLA-FONCET',
    'REBISE-JOD-MACT-MJFG-JHCT-RCT-FONCET',
    'REBISE-JOD-CPL-FONCET',
    'REBISE-JOD-RMS-BLC-RRT-GRE-FONCET',
    'REBISE-JOD-JLA-HMT-FONCET',
    'REBISE-JOD-RLS-FONCET',
    'REBISE-JOD-JFLS-FONCET',
    'REBISE-JOD-IMS-FONCET',
    'REBISE-JOD-JOC--FONCET',
    'REBISE-JOD-EPL-OPL-FONCET',
    'REBISE-JOD-MLT-FONCET',
    'REBISE-JOD-ALC-FONCET',
    'REBISE-JOD-PCB-FONCET',
    'REBISE-LM-FOD-FONCET',
    'REBISE-LM-ASR-FONCET',
    'REBISE-LM-RGM-FONCET',
    'REBISE-LM-HGN-FONCET',
    'REBISE-LM-RAJV-FONCET',
    'REBISE-LM-RGT-FONCET',
    'REBISE-LM-JLA-FONCET',
    'REBISE-LD-JNR-FONCET',
    'REBISE-LD-MANV-FONCET',
    'REBISE-LD-GNV-MCH-FONCET',
    'REBISE-LD-EDR-FONCET',
    'REBISE-LD-FEL-FONCET',
    'REBISE-LD-LSU-FONCET',
    'REBISE-LD-JAHD-FONCET',
    'REBISE-LD-ETR-FONCET',
    'REBISE-LD-GCP-FONCET',
    'REBISE-LD-FSC-FONCET',
    'REBISE-MH-FMR-FONCET',
    'REBISE-MH-LGT-FONCET',
    'REBISE-MH-ADSU-FONCET',
    'REBISE-MH1-ATR-FONCET',
    'REBISE-MH1-JVSL-FONCET',
    'REBISE-MH1-HMT-FONCET',
    'REBISE-MH1-ROL-FONCET',
    'REBISE-MH1-FTDL-FONCE',
    'REBISE-MH1-FJMH-FONCET',
    'REBISE- MH1- IMT-FONCET',
    'REBISE-MH1-RCS-FONCET',
    'REBISE-RLP-JFG-FONCET',
    'REBISE-RLP-MGV-FONCET',
    'REBISE-RLP-HDA-FONCET',
    'REBISE-RLP-MDR-FONCET',
    'REBISE-RLP-PSS-FONCET',
    'REBISE/RLP/ESA/FONCET',
    'REBISE-REP-AVL-FONCET',
    'REBISE-REP-FBP-FONCET',
    'REBISE-REP-GVC-FONCET',
    'REBISE-REP-HVC-FONCET',
    'REBISE-REP-GSC-FONCET',
    'REBISE-CR-OCLV-FONCET',
    'REBISE-CR-DDR-FONCET',
    'REBISE-CR-AZL-FONCET',
    'REBISE-CR-MCD-FONCET',
    'REBISE-LP-RSS-OLS-FONCET',
    'REBISE-LP-ASM-JLP-SJF-RS-RD-MC-JPC-FONCET',
    'REBISE-LP-SLC-FONCET',
    'REBISE-LP-LDC-WCS-FONCET',
    'REBISE-LP-CFV-DCF-FONCET',
    'REBISE-LP-MM-FONCET',
    'REBISE-LP-FCM-RMG-FONCET',
    'REBISE-LP-CFS-FONCET',
    'REBISE-LP-BSC-FONCET',
    'REBISE-LP-CMS-FONCET',
    'REBISE-LP-DDO-FONCET',
    'REBISE-LP-EGA-FONCET',
    'REBISE- LP- FLP-FONCET',
    'REBISE-LP-JSS-FONCET',
    'REBISE-LP-JEFV-FONCET',
    'REBISE-LP-JCOM-FONCET',
    'REBISE-LP-MFS-FONCET',
    'REBISE-LP-MCSP-FONCET',
    'REBISE-LP-OLS-FONCET',
    'REBISE- LP- VMS-FONCET',
    'REBISE- LP- WFV-FONCET',
    'REBISE-CR-AAS-FONCET',
    'APRN-FRANCISCO-TVP-FONCET',
    'REBISE-CR-ESU-FONCET',
    'REBISE-CR-MCRC-FONCET',
    'REBISE-CR-FOE-YVO-FONCET',
    'REBISE-CR-RMDP-ASC-RLTFONCET',
    'REBISE-CR-MRH-MSDR-JMRV-MELP-VACH-FONCET',
    'REBISE/CR/CMM/AMM/FONCET',
    'REBISE/CR/RMV/MMM/TMMFONCET',
    'REBISE/CR/JLMP/RVM/ELR/MOC/DGR/AGM/GGR/FONCET',
    'REBISE/RMF/PSE/FONCET',
    'REBISE/RFF/PR/FONCET',
    'REBISE/RFF/JRG/FONCET',
    'REBISE/RFF/ABG/FONCET',
    'REBISE/RFF/CAM/FONCET',
    'REBISE/RFF/HAS/FONCET',
    'REBISE/RFF/EBV/FONCET',
    'REBISE/RFF/EGS/FONCET',
    'REBISE/RFF/MAM/FONCET',
    'REBISE- RFF- AAM-FONCET',
    'REBISE- RFF- ASA-FONCET',
    'REBISE- RFF- EAF-FONCET',
    'REBISE- RFF- IDJSA-FONCET',
    'REBISE- RFF- JAF-FONCET',
    'REBISE- RFF- LASG-FONCET',
    'REBISE- RFF- LFRG-FONCET',
    'REBISE- RFF- MGS-FONCET',
    'REBISE- RFF- MTSA-FONCET',
    'REBISE- RFF- MAM-FONCET',
    'REBISE- RFF- MPG-FONCET',
    'REBISE- RFF- MGL-FONCET',
    'REBISE- RFF- OSC-FONCET',
    'REBISE- RFF- RCM-FONCET',
    'REBISE- TIL- JLSG-FONCET',
    'REBISE-LD-MUP-FONCET',
    'REBISE-MH-JTMD-FONCET',
    'REBISE-VC-JACR-FONCET-2023',
    'REBISE-FV1-RGM',
    'REBISE-FV1-AMR',
    'REBISE-5F-ERA-2025',
    'REBISE-TYL-GGL-2025',
    'REBISE-LP-RCM',
    'REBISE-RFM-HCM-2025',
    'REBISE-NIQ-REHJ-2025',
];

    protected $AprnSites = [
    'Ejido Monterrey',
    'Juan Sabines',
    'APRN-FRAILESCA-AS-CA-AH-FONCET',
    'APRN-FRAILESCA-EA-RR-FONCET',
    'APRN-FRAILESCA-RM-FONCET',
    'APRN-FRAILESCA-CA-FONCET',
    'APRN-FRAILESCA-SA-FONCET',
    'APRN-FRAILESCA-RIM-FONCET',
    'APRN-FRAILESCA-LAD-FONCET',
    'APRN-FRAILESCA-ECR-FONCET',
    'APRN-FRAILESCA-LEA-FONCET',
    'APRN-TIERRA-DR-FONCET',
    'APRN-TIERRA-DRE-FONCET',
    'APRN-TIERRA-LD-FONCET',
    'APRN-TIERRA-ET-FONCET',
    'APRN-TIERRA-UNIÓN-FONCET',
    'APRN-TIERRA-MG-AIS-FONCET',
    'APRN-TIERRA-RT-JRD-FONCET',
    'APRN-UNION-JA-FONCET',
    'APRN-UNION-JC-FONCET',
    'APRN-UNION-MH-FONCET',
    'APRN-UNION-LP-FONCET',
    'APRN-UNION-EM-FONCET',
    'APRN-UNION-MRRC-FONCET',
    'APRN-PIEDRAS-FJG-FONCET',
    'APRN-PIEDRAS-JGA-FONCET',
    'APRN-PIEDRAS-BVH-FONCET',
    'APRN-PIEDRAS-MAC-FONCET',
    'APRN-PIEDRAS-JMO-FONCET',
    'APRN-MARCOS-EAU-FONCET',
    'APRN-MARCOS-JUT-FONCET',
    'APRN-MARCOS-WUT-FONCET',
    'APRN-MARCOS-GUG-FONCET',
    'APRN-MARCOS-VHG-FONCET',
    'APRN-MARCOS-RMT-FONCET',
    'APRN-FRANCISCO-RL-FONCET',
    'APRN-FRANCISCO-RRL-FONCET',
    'APRN-FRANCISCO-RRJ-FONCET',
    'APRN-FEBRERO-HML-FONCET',
    'APRN-FRANCISCO-AMV-FONCET',
    'APRN-UNION-TMA-FONCET',
    'APRN-ZARAGOZA-YH-FONCET',
    'APRN-FEBRERO-ADS-FONCET',
    'APRN-OCOTAL-OHS-FONCET',
    'APRN-VILLAHERMOSA-FONCET',
    'APRN-VILLAHERMOSA-SHP-FONCET',
    'APRN-ARGENTINA-RCMKM-FONCET',
    'APRN-ARGENTINA-HRL-FONCET',
    'APRN-ARGENTINA-RJRL-FONCET',
    'APRN-ARGENTINA-RMRL-FONCET',
    'APRN-ARGENTINA-RJRH-FONCET',
    'APRN-LIBERTAD-AHM-FONCET',
    'APRN-VILLALAR-MSM-FONCET',
    'APRN-TIERRA-IRE-FONCET',
    'APRN-LIBERTAD-MPR-FONCET',
    'APRN-TIERRA-GRE-FONCET',
    'APRN-LIBERTAD-JASP-FONCET',
    'APRN-TIERRA-RTJ-FONCET',
    'APRN-LIBERTAD-CGP-FONCET',
    'APRN-LIBERTAD-MPJ-FONCET',
    'APRN-LIBERTAD-MGE-FONCET',
    'APRN-LIBERTAD-GGN-FONCET',
    'APRN-LIBERTAD-AAG-FONCET',
    'APRN-LIBERTAD-EVGI-FONCET',
    'APRN-LIBERTAD-ETM-FONCET',
    'APRN-LIBERTAD-EBBLD-FONCET',
    'APRN-LIBERTAD-ASA-FONCET',
    'APRN-LIBERTAD-EAA-FONCET',
    'APRN-BRISAS-RME-FONCET',
    'APRN-LIBERTAD-OSZ-FONCET',
    'APRN-LIBERTAD-ANV-FONCET',
    'APRN-LIBERTAD-JEL-FONCET',
    'APRN-LIBERTAD-JMS-FONCET',
    'APRN-LIBERTAD-MHM-FONCET',
    'APRN-BRISAS-RANE-FONCET',
    'APRN-BRISAS-EME-FONCET',
    'APRN-BRISAS-AHC-FONCET',
    'APRN-BRISAS-HME-FONCET',
    'APRN-BRISAS-ASJ-FONCET',
    'APRN-BRISAS-ANE-FONCET',
    'APRN-BRISAS-MVE-FONCET',
    'APRN-REFORMA-MNM-FONCET',
    'APRN-REFORMA-GRG-FONCET',
    'APRN-REFORMA-ANM-FONCET',
    'APRN-FEBRERO-RML-FONCET',
    'APRN-FEBRERO-EVP-FONCET',
    'APRN-REFORMA-MANM-FONCET',
    'APRN-AYALA-GJM-FONCET',
    'APRN-REFORMA-NPG-FONCET',
    'APRN-REFORMA-ACD-FONCET',
    'APRN-FRANCISCO-EFM-FONCET',
    'APRN-RANCHOLIBERTAD-LRJ-FONCET',
    'APRN-PINOS-EPJ-FONCET',
    'APRN-UNION-FTC-FONCET',
    'APRN-LAZARO-FONCET',
    'APRN-LAZARO-MV-FONCET',
    'APRN-LAZARO-DG-FONCET',
    'APRN-FEBRERO-JVV-FONCET',
    'APRN-FEBRERO-JZU-FONCET',
    'APRN-FEBRERO-PND-FONCET',
    'APRN-PIEDRAS-LRV-FONCET',
    'APRN-PINAVETAL-JMS-FONCET',
    'APRN-FRANCISCO-ICP-FONCET',
    'APRN-FRANCISCO-OHE-FONCET',
    'APRN-ZARAGOZA-EIZ-FONCET',
    'APRN-AYALA-PA-FONCET',
    'APRN-TIERRA-ACM-FONCET',
    'APRN-TIERRA-RHC-FONCET',
    'APRN-TIERRA-YCM-FONCET',
    'APRN-TIERRA-CML-FONCET',
    'APRN-TIERRA-JF-FONCET',
    'APRN-ARGENTINA-MRL-FONCET',
    'APRN-ARGENTINA-JRL-FONCET',
    'APRN-ARGENTINA-HK-FONCET',
    'APRN-ARGENTINA-MRE-FONCET',
    'APRN-ARGENTINA-CMR-FONCET',
    'APRN-ARGENTINA-JRH-FONCET',
    'APRN-FEBRERO-AZU-FONCET',
    'APRN-FEBRERO-JCZ-FONCET',
    'APRN-PLAN-TPM-FONCET',
    'APRN-TIERRA-LTR-FONCET',
    'APRN-FRANCISCO-CPM-FONCET',
    'APRN-FEBRERO-BGL-FONCET',
    'APRN-ZARAGOZA-MTV-FONCET',
    'APRN-REFORMA-JRS-FONCET',
    'APRN-JAOM-PIEDRAS',
    'APRN-MARV-PIEDRAS',
    'APRN-MCRRA-AGUA_DULCE',
    'APRN-JGN-MURGUIA',
    'APRN-MONTE-ALBAN',
    'APRN-LEGE-MONTERREY',
    'APRN-JLV-PIEDRAS',
    'APRN-MADERO-2025',
    'APRN-RHC-TIERRA',
    'APRN-OML-FEBRERO',
    'APRN-ALM-MURGUIA',
    'APRN-JTG-FORTUNA',
    'APRN-MAVH-PIEDRAS',
    'APRN-MDE-ZARAGOZA',
    'APRN-MMSPV-MURGUIA',
    'APRN-MT.NT-MURGUIA',
    'APRN-HRH-BRISAS',
    'APRN-RMV-NUEVAUNION',
    'APRN-HJC-SANJUAN',
    'APRN-MC.GC.CC.MCCV-COMUNEROS',
    'APRN-GC.GV-COMUNEROS',
    'APRN-JCPT-COMUNEROS',
    'APRN-LB-COMUNEROS',
    'APRN-MM-COMUNEROS',
    'APRN-ALH-N.ESPERANZA',
    'APRN-AM.FA.RA-N.ESPERANZA',
    'APRN-JEQA-N.ESPERANZA',
    'APRN-MR.JD.JC-N.ESPERANZA',
    'APRN-RMB-COMUNEROS',
];

    /**
     * Execute the console command.
     */
    public function handle()
    {
        $this->info('Starting the project FONCET and site migration process...');

        $foncetNameProject = 'FONCET/Restauración en Áreas Naturales Protegidas';

        $foncetProject = Project::where('name', $foncetNameProject)->first();
        if (! $foncetProject) {
            $this->error('FONCET Project not found.');

            return Command::FAILURE;
        }

        $newProjects = [ ['name' => 'REBIVTA'], ['name' => 'REBITRI'], ['name' => 'REBISO'], ['name' => 'REBISE'], ['name' => 'APRN FRAILESCANA']];
        $sitesAssociation = [
            'REBIVTA' => $this->rebivtaSites,
            'REBITRI' => $this->rebitriSites,
            'REBISO' => $this->rebisoSites,
            'REBISE' => $this->rebiseSites,
            'APRN FRAILESCANA' => $this->AprnSites,
        ];


        $lastPpcExternalId = $this->getLastPpcExternalId() ?? 0;

        foreach ($newProjects as $newProject) {
            $project = Project::firstOrCreate(array_merge($foncetProject->toArray(), ['uuid' => Str::uuid()], ['ppc_external_id' => ++$lastPpcExternalId], ['name' => $newProject['name']]));
            $this->info("Project '{$project->name}' ensured with UUID: {$project->uuid}");

            $this->moveSitesToProject($project, $sitesAssociation[$newProject['name']]);
            // $this->moveTasks($foncetProject, $project);
        }

    }

    /**
     * Move sites from the FONCET project to the new project.
     *
     * @param $newProject
     * @param mixed $siteNames
     * @return void
     */
    private function moveSitesToProject($newProject, mixed $siteNames): void
    {
        foreach ($siteNames as $siteName) {
            $site = Site::where('name', $siteName)->first();
            if (! $site) {
                $this->error("Site name '{$siteName}' not found. Skipping...");

                continue;
            }
            $oldProject = $site->project()->first();
            $site->project()->associate($newProject);
            $site->save();
            $this->info("Site '{$site->name}' moved from project '{$oldProject->name}' to '{$newProject->name}'");
        }
    }

    /**
     * Move tasks from the FONCET project to the new project.
     * @param $foncetProject
     * @param $project
     * @return void
     */
    private function moveTasks($foncetProject, $project): void
    {
        $tasks = Task::where('project_id', $foncetProject->id)->get();
        $this->info('Found ' . count($tasks) . " tasks to copy from project ID '{$foncetProject->id}' to project '{$project->name}'");

        foreach ($tasks as $task) {
            $newTask = Task::firstOrCreate(array_merge($task->toArray(), ['uuid' => Str::uuid()], ['project_id' => $project->id, 'created_at' => now(), 'updated_at' => now()]));
            $this->info("Task uuid: {$newTask->uuid} created a copy for project '{$project->name}'");
        }

    }

    /**
     * Get the last value for ppc_external_id from the projects table.
     *
     * @return int|null
     */
    private function getLastPpcExternalId(): ?int
    {
        return \DB::table('v2_projects')
            ->whereNotNull('ppc_external_id')
            ->orderBy('ppc_external_id', 'desc')
            ->value('ppc_external_id');
    }
}
